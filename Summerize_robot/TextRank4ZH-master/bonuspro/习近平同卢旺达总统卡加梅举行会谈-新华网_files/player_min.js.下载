document.domain="xinhuanet.com";var G_PLAYER_INSTANCE=null;
(function(){var a=false,b=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=true;var g=new this;a=false;for(var f in c)g[f]=typeof c[f]=="function"&&typeof e[f]=="function"&&b.test(c[f])?function(h,i){return function(){var j=this._super;this._super=e[h];var k=i.apply(this,arguments);this._super=j;return k}}(f,c[f]):c[f];d.prototype=g;d.constructor=d;d.extend=arguments.callee;
return d}})();var argumentsToArray=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};Function.prototype.delayApply=function(a,b,c){var d=this;return setTimeout(function(){d.apply(b,c)},a)};Function.prototype.delayCall=function(a,b){return this.delayApply(a,b,argumentsToArray(arguments).slice(2))};
var KankanObj=Class.extend({init:function(){this.isIE=navigator.appName.indexOf("Microsoft")!=-1;this.verFlashplayer=this.getFPVer()},getFPVer:function(){try{return(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).getVariable("$version").split(" ")[1].split(",")}catch(a){for(var b=navigator.plugins,c=b.length-1;c>=0;c--)try{if(b[c].name.indexOf("Shockwave Flash")!=-1)return b[c].description.match(/\d+/g)}catch(d){}}finally{}},mStatSend:function(a){var b=new Image(1,1);b.onerror=function(){};b.src=
a},trace:function(a,b){if(b=="onProgress")return false;try{var c=new Date,d=G_PLAYER_ERROR,e=c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()+"."+c.getTime()%1E3;d.debugBuffer.unshift(e+"  : "+a+","+b);d.debugBuffer=d.debugBuffer.slice(0,1E3)}catch(g){}},getParameter:function(a){a=RegExp("[?&]"+a+"=([^&#]+)","g");try{var b=a.exec(this.getLoc())}catch(c){}return null!=b?decodeURIComponent(b[1]):null},rand:function(a,b){return a+Math.round(Math.random()*(b-a))},getLoc:function(){try{return document.location.href}catch(a){}},
$:function(a){return document.getElementById(a)},getCookie:function(a){try{var b=document.cookie.match(RegExp("(^"+a+"| "+a+")=([^;]*)"))==null?"":decodeURIComponent(RegExp.$2);return b!=""?b:""}catch(c){return""}},time:function(){return(new Date).getTime()},pageRefresh:function(){var a=window.location.href.split("#");window.location=window.location.href.indexOf("?")>0?a[0]+"&rd="+this.time():a[0]+"?rd="+this.time();return true},$C:function(a){return document.createElement(a)},$P:function(a,b){return b?
b.appendChild(a):document.body.appendChild(a)}}),KankanEventObj=KankanObj.extend({init:function(){this._super();this.attachEvent=this.addEventListener;this.detachEvent=this.removeEventListener;this.fireEvent=this.dispatchEvent},addEventListener:function(a,b,c,d){this[b]||(this[b]=[]);if(!(this[b]instanceof Array))return false;for(var e=0;e<this[b].length;e++)if(this[b][e].o==a&&this[b][e].f==c)return true;this[b].push({o:a,f:c,t:d});return true},removeEventListener:function(a,b,c){if(!this[b]||!(this[b]instanceof
Array))return false;for(var d=0;d<this[b].length;d++)if(this[b][d].o==a&&this[b][d].f==c){this[b].splice(d,1);0==this[b].length&&delete this[b];return true}return false},dispatchEvent:function(a){if(!this[a]||!(this[a]instanceof Array))return false;for(var b=[this].concat(argumentsToArray(arguments)),c=this[a].slice(0),d=0;d<c.length;d++)typeof c[d].t=="number"?c[d].f.delayApply(c[d].t,c[d].o,b):c[d].f.apply(c[d].o,b);return true}}),KKPlayerError=KankanEventObj.extend({init:function(){this._super();
this.errorMap={"003":"Flash 初始化失败,清除浏览器缓存,再刷新页面重试","004":'检测到Flash Player控件异常,请先安装最新版本Flash Player。<a href="http://get.adobe.com/cn/flashplayer/" target="_blank">立即下载安装Flash Player</a>',"100":"没找到播放地址,请选择播放其他节目|"};this.lastError="";this.count=0;this.debugBuffer=[]},reInit:function(){this.bufferError=this.dapctrlError=false},dump:function(a,b){this.count++;this.trace("------ERROR-CODE:"+a);if(b)return false;if(typeof this.errorMap[a]!="undefined"){this.showError(a,this.errorMap[a]);return true}return false},
showError:function(a,b){var c=G_PLAYER_INSTANCE,d=b.split("|");if(typeof c!="undefined"&&c&&typeof c.showError!="undefined")c.showError(escape(d[0]),escape(d[1]));else try{this.showOnPage(d[0],a)}catch(e){}},showOnPage:function(a,b){if(b=="003"||b=="004")this.$("playerError").className="error";else this.$("playerError").className="errortxt";this.$("playerError").style.display="";this.$("playerError").innerHTML='<p id="playerErrorContent">'+a+"<br/></p>"},playCheck:function(a){if(!this.errorDetectDelay){this.errorHasPlay=
false;this.errorDetectDelay=true;this.playCheckDelay.delayCall(6E4,G_PLAYER_ERROR,a)}},playCheckDelay:function(a){var b=G_PLAYER_INSTANCE;if(!this.errorHasPlay){this.dump("T"+a,true,b.getEventQueue()+"_"+b.getBufferBugInfo()+"_"+b.getPlayPosition());this.fireEvent("onTerr")}this.errorDetectDelay=this.errorHasPlay=false},changeInstallPlay:function(){this.fireEvent("onChangeInstallPlay")},getDebugInfo:function(){for(var a="",b=0;b<this.debugBuffer.length;b++)a+=this.debugBuffer[b]+"\r\n";return a}}),
KKPlayerInit=KankanEventObj.extend({init:function(){this._super();this.playerLoaded=false;this.playerPath="http://misc.vod.news.cn/v/misc/KKPlayer2.0_xhn.swf";this.checkPlayerTime=0},printObject:function(a,b,c,d,e){this.getCookie("player_mode");this.trace("printObject start");this.playerPath+="?movieType="+e+"&v=2.9&popup="+(navigator.userAgent.indexOf("MSIE")!=-1?"1":"0");if(typeof SWFObject=="undefined"){G_PLAYER_ERROR.dump("000");this.printObjectManually(a,b,c,d)}else{b=new SWFObject(this.playerPath,
"PlayerCtrl",c,d,"10","#000000");b.addParam("allowScriptAccess","always");b.addParam("allowFullScreen","true");b.addParam("wmode","window");b.addParam("quality","high");b.skipDetect=false;if(!b.write(a)){G_PLAYER_ERROR.dump("004");b=new SWFObject(this.playerPath,"PlayerCtrl","1","1","10","#000000");b.skipDetect=true;b.write(a);return false}}this.checkPlayer.delayCall(0,this)},printObjectManually:function(a,b,c,d){if(this.isIE){b="";b+='<object width="'+c+'" height="'+d+'" id="PlayerCtrl" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"  >';
b+='<PARAM NAME="_cx" VALUE="25664"><PARAM NAME="_cy" VALUE="13917"><PARAM NAME="FlashVars" VALUE="">';b+='<PARAM NAME="Movie" VALUE="'+this.playerPath+'"><PARAM NAME="Src" VALUE="'+this.playerPath+'"><PARAM NAME="WMode" VALUE="Window">';b+='<PARAM NAME="Play" VALUE="0"><PARAM NAME="Loop" VALUE="-1"><PARAM NAME="Quality" VALUE="High"><PARAM NAME="SAlign" VALUE="LT">';b+='<PARAM NAME="Menu" VALUE="0"><PARAM NAME="Base" VALUE=""><PARAM NAME="AllowScriptAccess" VALUE="always"><PARAM NAME="Scale" VALUE="NoScale">';
b+='<PARAM NAME="DeviceFont" VALUE="0"><PARAM NAME="EmbedMovie" VALUE="0"><PARAM NAME="BGColor" VALUE="000000"><PARAM NAME="SWRemote" VALUE="">';b+='<PARAM NAME="MovieData" VALUE=""><PARAM NAME="SeamlessTabbing" VALUE="1"><PARAM NAME="Profile" VALUE="-1"><PARAM NAME="ProfileAddress" VALUE="">';b+='<PARAM NAME="ProfilePort" VALUE="830362444"><PARAM NAME="AllowNetworking" VALUE="all"><PARAM NAME="AllowFullScreen" VALUE="true">';b+="</object>";this.$(a).innerHTML=b}},checkSwfInterface:function(){return typeof this.$("PlayerCtrl").flv_setPlayeUrl==
"undefined"?false:true},checkPlayer:function(){this.checkPlayerTime++;if(typeof this.$("PlayerCtrl").flv_setPlayeUrl=="undefined")this.checkPlayer.delayCall(50,this);else{G_PLAYER_INSTANCE=new KKPlayerInstance;if(!G_PLAYER_INSTANCE){this.checkPlayer.delayCall(50,this);return false}this.fireEvent("onload");this.playerLoaded=true;this.trace("init success")}this.checkPlayerTime==200&&G_PLAYER_ERROR.dump("009",true)}}),KKPlayerInstance=KankanEventObj.extend({init:function(){this._super();this.pobject=
this.$("PlayerCtrl");this.paramobj=[];this.qualitystr="000";this.bufferStart=10;this.title="";this.submovieid=this.qualitytype=0;this.lastEvent="init";this.qualitySwitch=false;this.qualitySwitchStart=0;this.timeStampObj={open:0,fopen:0,play:0};this.eventQueue=[0,0,0,0,0,0,0,0,0,0];this.isServer=false;this.totleTime=this.totleByte=this.bufferTimes=this.skipEnd=this.skipStart=0;this.isFinal=this.interruptStat=false;this.frontpageUrl=""},close:function(){try{this.pobject.flv_close()}catch(a){}this.setLastEvent("init",
0)},pause:function(){this.pobject.flv_pause()},play:function(){this.pobject.flv_play()},stop:function(){this.pobject.flv_stop()},fpstop:function(){this.pobject.flv_stop()},getPlayPosition:function(){return this.pobject.getPlayProgress(true)},getBufferProgress:function(){return this.pobject.getBufferProgress()},getBufferedPos:function(){return this.pobject.getBufferEnd()},setStartMsg:function(a,b,c){this.start=parseInt(a)||0;this.start=this.start>0?this.start:0;this.subStart=parseInt(b)||0;this.subEnd=
parseInt(c)||0},flashopen:function(a,b,c,d){if(this.qualitySwitch){this.qualityFlashopen(a);return false}this.bufferTimes=0;var e=eval('[{url:"",start:0,autoplay:1,quality:0,qualitystr:"000",qualitytype:0,subStart:0,subEnd:0,title:"",vcut:0,submovieid:0,skipMovieHeadTime:0,skipMovieEndTime:0,streamtype:0,posterUrl:"",totleByte:0,totleTime:0,sliceTime:0,finalSub:0,frontpageUrl:""}]');e[0].url=a;e[0].surl=this.sourceUrl||this.lastVideoUrl;e[0].start=parseInt(this.start);e[0].autoplay=d||1;e[0].quality=
parseInt(this.quality);e[0].qualitystr=this.qualitystr;e[0].title=this.title;e[0].vcut=this.vcut;e[0].frontpageUrl=this.frontpageUrl;e[0].qualitytype=this.qualitytype;e[0].submovieid=this.submovieid;e[0].posterUrl=this.poster;e[0].finalSub=this.isFinal;if(b){e[0].totalByte=this.totalByte;e[0].totalTime=this.totalTime;e[0].sliceTime=0;if(G_PLAYER_INIT.issvod)e[0].sliceTime=this.totalTime}if(c){e[0].jsonObj=c;e[0].autoplay=d?d:2}e[0].gcid=this.gcid;if(b){this.isServer=true;e[0].streamtype=1;e[0].packageUrl=
this.packageUrl}else{this.isServer=false;e[0].streamtype=0}if(this.subEnd>this.subStart){e[0].subStart=this.subStart;e[0].subEnd=this.subEnd}e[0].skipMovieHeadTime=this.skipStart;e[0].skipMovieEndTime=this.skipEnd;e[0].playMode="p2s";this.paramobj=e;this.pobject.setBufferTime(this.bufferStart);this.pobject.flv_setPlayeUrl(e);G_PLAYER_INSTANCE.setURLTime=parseInt((new Date).valueOf());this.timeStampObj.fopen=parseInt((new Date).valueOf())},qualityFlashopen:function(a){this.qualitySwitch=false;this.paramobj[0].url=
a;this.paramobj[0].start=this.qualitySwitchStart;this.paramobj[0].quality=parseInt(this.paramobj[0].quality)+1;this.pobject.setChangeUrl(this.paramobj[0])},showError:function(a,b){try{this.pobject.flv_stop()}catch(c){}if(b=="")b="";this.pobject.flv_handleError(a,b)},getPlayStatus:function(){var a=this.pobject.getPlayStatus();return a==-1?"init":a==0?"playing":a==1?"pause":a==2?"stop":a==3?"replay":"undefined"},getDownloadSpeed:function(){return parseInt(this.pobject.getDownloadSpeed())},getDownloadProgress:function(){return 0},
getDownloadProgressAll:function(){return 0},windowOpen:function(a){window.open(a)},setSpolierXml:function(a){this.pobject.flv_setSpolierXml(a)},setPlayPosition:function(a){this.pobject.flv_setSeekPos(a)},cutStreamLink:function(){this.pobject.cutStreamLink()},closeAdPlaying:function(){this.pobject.flv_closeAdPlaying()},getDuration:function(){return this.pobject.getDuration()},getDownloadPos:function(){return this.pobject.getDuration()>0&&this.getDownloadProgressAll()>0?this.pobject.getDuration()*this.getDownloadProgressAll()/
1E4:0},getErrorInfo:function(){return this.pobject.getErrorInfo()},changeBufferTime:function(a){if(a>0){this.trace("player changeBufferTime ="+a);return this.pobject.flv_changeBufferTime(a)}},setIsSkipMovieHead:function(a){return this.pobject.flv_setIsSkipMovieHead(a)},setIsAutoChangeQuality:function(a){return this.pobject.flv_setIsAutoChangeQuality(a)},getPlayerConfig:function(){return this.pobject.flv_getSetStatusInfo()},getBufferLength:function(){return this.pobject.flv_getBufferLength()},setLastEvent:function(a,
b){this.lastEvent=a;if(b>0){this.eventQueue.unshift(b);this.eventQueue=this.eventQueue.slice(0,10)}},getEventQueue:function(){return this.eventQueue.join("-")},getBufferBugInfo:function(){return this.pobject.flv_getBufferBugInfo()},getFlashVer:function(){try{return G_PLAYER_INIT.getFPVer()}catch(a){}},getStageVideoInfo:function(){return this.pobject.flv_stageVideoInfo()},setFullScreen:function(a){return this.pobject.flv_setFullScreen(a)},getCurrentFps:function(){return this.pobject.flv_getNsCurrentFps()},
setIsChangeQuality:function(){return this.pobject.flv_setIsChangeQuality(true)},setQualityBtn:function(a){return this.pobject.flv_setQualityBtn(a)},flvExternalCommand:function(a,b){return this.pobject.flv_externalCommand(a,b)},setRecommendXmlUrl:function(a,b){this.pobject.flv_setRecommendXmlUrl(a,b);this.showVideoRecommend(false)},showVideoRecommend:function(a){this.pobject.flv_showRecommend(a)},showVideoPlayNextBtn:function(a){this.pobject.setBtnNextVisible(a)},getFlvStat:function(a){try{return this.pobject.flv_getStat(a)}catch(b){return""}},
setFlvStat:function(a,b){try{this.pobject.flv_setStat(a,b)}catch(c){}},flvGet:function(a){try{return this.pobject.flv_get(a)}catch(b){return false}},flvSet:function(a,b){try{this.pobject.flv_set(a,b);return true}catch(c){return false}}});
function flv_playerEvent(a,b){var c=G_PLAYER_INSTANCE,d=G_PLAYER_ERROR;if(a=="onbuffering"){var e=c.lastEvent;c.setLastEvent("onbuffering",2);c.isBuffering=true;c.getPlayPosition();e=="onBuffering"&&d.dump("014",true)}else if(a=="onplaying"){d.bufferError=false;c.isBuffering=false;c.setLastEvent("onplaying",3);c.timeStampObj.play=parseInt((new Date).valueOf());d.errorHasPlay=true}else if(a=="onPause")c.setLastEvent("onPause",6);else if(a=="onSeek")c.setLastEvent("onSeek",4);else if(a=="onopen")c.setLastEvent("onopen",
1);else if(a=="onStop"){if(G_PLAYER_INSTANCE.lastEvent=="onStop")return false;c.setLastEvent("onStop",9)}else if(a=="onEnd")c.setLastEvent("onEnd",7);else if(a=="autoChangeQulity"){c.setLastEvent("autoChangeQulity",8);c.setNoticeMsg("智能切换清晰度已完成")}else if(a=="hideNoticeBar"){G_PLAYER_INSTANCE.isAlwaysNotice=false;G_PLAYER_INSTANCE.flvSet("showInnerNotice",true)}c.fireEvent.delayCall(5,c,a,b)}var G_PLAYER_ERROR=new KKPlayerError,G_PLAYER_INIT=new KKPlayerInit;
